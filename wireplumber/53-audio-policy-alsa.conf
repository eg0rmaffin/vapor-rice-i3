# ─────────────────────────────────────────────
# ALSA Node Policy: disable aggressive suspend
#
# Problem: WirePlumber suspends ALSA nodes after 5 seconds of idle.
#          This causes audible delays when playback resumes and can
#          interact badly with device hot-plug (suspend/resume cycles).
#
# Policy:  Audio devices stay awake. No pop/click on resume.
#          Audio treated as infrastructure, not battery optimization.
#
# Applies to: WirePlumber 0.5+ (SPA-JSON format)
# Deployed to: ~/.config/wireplumber/wireplumber.conf.d/
# ─────────────────────────────────────────────

monitor.alsa.rules = [
  {
    matches = [
      { node.name = "~alsa_output.*" }
    ]
    actions = {
      update-props = {
        # Disable idle suspension (default: 5 seconds)
        # 0 = never suspend — eliminates audio pops on resume
        session.suspend-timeout-seconds = 0
      }
    }
  }
  {
    matches = [
      { node.name = "~alsa_input.*" }
    ]
    actions = {
      update-props = {
        # Disable idle suspension for inputs too
        session.suspend-timeout-seconds = 0
      }
    }
  }
]

#!/bin/bash
# Удаление снэпшота
# Usage: snapshot-delete <snapshot_number>

GREEN="\033[0;32m"
CYAN="\033[0;36m"
YELLOW="\033[1;33m"
RED="\033[0;31m"
RESET="\033[0m"

# Проверяем, настроен ли Snapper
if ! sudo snapper -c root list &>/dev/null; then
    echo -e "${RED}❌ Snapper не настроен. Запустите snapshot_setup.sh${RESET}"
    exit 1
fi

if [ -z "$1" ]; then
    echo -e "${YELLOW}Использование: snapshot-delete <номер>${RESET}"
    echo -e "${CYAN}Пример: snapshot-delete 5${RESET}"
    echo ""
    echo -e "${CYAN}Доступные снэпшоты:${RESET}"
    sudo snapper -c root list
    exit 1
fi

echo -e "${YELLOW}⚠️  Вы уверены, что хотите удалить снэпшот $1? (y/N)${RESET}"
read -r confirm
if [ "$confirm" = "y" ] || [ "$confirm" = "Y" ]; then
    if sudo snapper -c root delete "$1"; then
        echo -e "${GREEN}✅ Снэпшот $1 удален${RESET}"
    else
        echo -e "${RED}❌ Ошибка при удалении снэпшота${RESET}"
        exit 1
    fi
else
    echo -e "${CYAN}Отменено${RESET}"
fi

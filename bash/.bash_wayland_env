# Wayland/Sway environment configuration
# Source this file before starting Wayland session

# ─── NVIDIA-specific Wayland environment variables ──────
if lspci | grep -i 'vga\|3d\|display' | grep -i 'nvidia' &>/dev/null; then
    # Включаем GBM backend для NVIDIA (требуется для Wayland)
    export GBM_BACKEND=nvidia-drm
    export __GLX_VENDOR_LIBRARY_NAME=nvidia

    # Включаем Wayland для приложений, поддерживающих его
    export MOZ_ENABLE_WAYLAND=1
    export QT_QPA_PLATFORM=wayland
    export SDL_VIDEODRIVER=wayland
    export _JAVA_AWT_WM_NONREPARENTING=1

    # Оптимизации для NVIDIA
    export __GL_GSYNC_ALLOWED=1
    export __GL_VRR_ALLOWED=1
    export __GL_SHADER_DISK_CACHE=1
    export __GL_SHADER_DISK_CACHE_SKIP_CLEANUP=1

    # Для корректной работы некоторых приложений
    export WLR_NO_HARDWARE_CURSORS=1
fi

# ─── Общие переменные для Wayland ──────
export XDG_SESSION_TYPE=wayland
export XDG_CURRENT_DESKTOP=sway
